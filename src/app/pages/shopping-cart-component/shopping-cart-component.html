<table mat-table [dataSource]="cartItems" class="mat-elevation-z8" *ngIf="cartItems.length">

  <!-- Image -->
  <ng-container matColumnDef="image">
    <th mat-header-cell *matHeaderCellDef>Product</th>
    <td mat-cell *matCellDef="let item">
      <img [src]="item.imageUrl" width="60">
    </td>
  </ng-container>

  <!-- Name -->
  <ng-container matColumnDef="name">
    <th mat-header-cell *matHeaderCellDef>Name</th>
    <td mat-cell *matCellDef="let item">{{ item.name }}</td>
  </ng-container>

  <!-- Price -->
  <ng-container matColumnDef="price">
    <th mat-header-cell *matHeaderCellDef>Unit Price</th>
    <td mat-cell *matCellDef="let item">Rs. {{ item.unitPrice | number }}</td>
  </ng-container>

  <!-- Quantity -->
  <ng-container matColumnDef="qty">
    <th mat-header-cell *matHeaderCellDef>Qty</th>
    <td mat-cell *matCellDef="let item">
      <input type="number"
             min="1"
             [max]="item.maxStock"
             [(ngModel)]="item.quantity"
             (ngModelChange)="onQtyChange(item)"
             style="width:70px">
    </td>
  </ng-container>

  <!-- Subtotal -->
  <ng-container matColumnDef="subtotal">
    <th mat-header-cell *matHeaderCellDef>Subtotal</th>
    <td mat-cell *matCellDef="let item">
      Rs. {{ item.subtotal | number }}
    </td>
  </ng-container>

  <!-- Action -->
  <ng-container matColumnDef="action">
    <th mat-header-cell *matHeaderCellDef></th>
    <td mat-cell *matCellDef="let item">
      <button mat-button color="warn" (click)="removeItem(item.productId)">
        Remove
      </button>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
</table>

<!-- Footer -->
<div class="cart-footer" *ngIf="cartItems.length" style="text-align:right;margin-top:20px">
  <h3>Total: Rs. {{ total | number }}</h3>
  <button mat-raised-button color="primary" (click)="placeOrder()">
    Place Order
  </button>
</div>

<p *ngIf="!cartItems.length">Your cart is empty.</p>
